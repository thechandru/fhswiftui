"""API for helpers, layout components, UI components, and style modifiers."""

# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/00_core.ipynb.

# %% auto 0
__all__ = ['bc_link', 'tw_scr', 'fh_swiftui_hdrs', 'p', 'IncludeColors', 'mk_previewer']

# %% ../nbs/00_core.ipynb 2
from fastcore.utils import *
from fasthtml.common import *
import fasthtml.components as fh
from fasthtml.jupyter import *

# %% ../nbs/00_core.ipynb 4
def _def_colors():
    base = ["primary","secondary","accent","muted","card","popover"]
    return base+[f"{o}-foreground" for o in base]+["background","foreground","destructive","ring","input","border"]
    

# %% ../nbs/00_core.ipynb 5
def IncludeColors(
    colors=None,    # list of tailwind colors
    append=True     # append or replace the default colors
):
    "Include additional colors that wil be used in the page"
    from itertools import product
    if not colors: colors = []
    pr = [f"border-{o}" for o in "lrtb"] + ["bg","text","border"]
    
    return Div(cls=f"hidden {' '.join(f'{p}-{c}' for p,c in product(pr,_def_colors() + colors if append else colors))}")

# %% ../nbs/00_core.ipynb 6
# enable basecoat and tailwind; add useful default colors
bc_link = Link(rel='stylesheet', href='https://cdn.jsdelivr.net/npm/basecoat-css@latest/dist/basecoat.cdn.min.css')
tw_scr = Script(src='https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4')

fh_swiftui_hdrs = (bc_link,tw_scr,IncludeColors())


# %% ../nbs/00_core.ipynb 8
def mk_previewer(app=None,hdrs=fh_swiftui_hdrs,cls=f'max-w-lg'):
    xcls = cls
    if not app: app=FastHTML(hdrs=hdrs)
    def p(*c, cls='', **kw):
        return HTMX(Div(cls=f'{xcls} {cls}')(*c), app=app, host=None, port=None, **kw)
    return p

# Based completely on: https://answerdotai.github.io/fhdaisy/core.html#mk_previewer

# %% ../nbs/00_core.ipynb 9
p = mk_previewer()

# %% ../nbs/00_core.ipynb 13
@patch
def append_classes(
    self:FT, # the tag
    *c       # list of classes
):
    "Append css classes to the FastTag element"
    self.attrs["class"] = " ".join(f"{self.attrs.get('class','')} {' '.join(c)}".split())
    return self

# %% ../nbs/00_core.ipynb 15
@patch
def padding(
    self:FT,     # The FastTag element to modify
    **kw         # Padding values: 'all', 'top', 'bottom', 'left', 'right' (Tailwind spacing scale: 0, 1, 2, 4, 8, px, or custom like '[5px]')
):
    "Add padding around the content within the element's bounds. Defaults to p-4 if no arguments provided."
    d = {"top":'t', "bottom":'b', "left":'l', "right":'r'}
    c = [f"p-{kw['all']}"] if "all" in kw else [f"p{d[k]}-{kw[k]}" for k in set(kw) & d.keys()]
    return self.append_classes(*c if c else ["p-4"])

# %% ../nbs/00_core.ipynb 17
# Test with different padding options
Div("Default", cls="bg-blue-200").padding()

# %% ../nbs/00_core.ipynb 18
# Test with different padding options
p(Div("Default", cls="bg-blue-200").padding())

# %% ../nbs/00_core.ipynb 19
Div("All sides", cls="bg-blue-200").padding(all=6)

# %% ../nbs/00_core.ipynb 20
p(Div("All sides", cls="bg-blue-200").padding(all=6))

# %% ../nbs/00_core.ipynb 21
Div("Top and bottom", cls="bg-blue-200").padding(top=2, bottom=8)

# %% ../nbs/00_core.ipynb 22
p(Div("Top and bottom", cls="bg-blue-200").padding(top=2, bottom=8))

# %% ../nbs/00_core.ipynb 24
@patch
def margin(self:FT,**kw):
    d = {"top":'t',"bottom":'b',"left":'l',"right":'r'}
    c = [f"m-{kw['all']}"] if "all" in kw else [f"m{d[k]}-{kw[k]}" for k in set(kw) & d.keys()]

    self.append_classes(*c if c else ["m-4"])

    return self

# %% ../nbs/00_core.ipynb 26
# Default margin
p(Div("Default", cls="bg-blue-200").margin())

# %% ../nbs/00_core.ipynb 27
# All sides
p(Div("All sides", cls="bg-blue-200").margin(all=6))

# %% ../nbs/00_core.ipynb 28
# Top and bottom
p(Div("Top and bottom", cls="bg-blue-200").margin(top=2, bottom=8))

# %% ../nbs/00_core.ipynb 30
@patch
def border(
    self:FT,         # The FastTag element to modify
    width:int=None,  # Border width in Tailwind scale (1, 2, 4, 8) or None for default width
    color:str=None   # Tailwind border color without 'border-' prefix (e.g., 'primary', 'muted', 'gray-300', 'red-500')
):
    "Add a border around the element with optional width and color customization"
    c = ["border"]
    if width: c.append(f"border-{width}")
    if color: c.append(f"border-{color}")
    return self.append_classes(*c)

# %% ../nbs/00_core.ipynb 32
p(Div("Test").border())

# %% ../nbs/00_core.ipynb 33
p(Div("Test").border(width=2,color="blue-500"))

# %% ../nbs/00_core.ipynb 34
p(Div("Test").border(color="red-300"))

# %% ../nbs/00_core.ipynb 35
p(Div("Test").border().padding().margin())

# %% ../nbs/00_core.ipynb 37
@patch
def corner_radius(
    self:FT,        # The FastTag element to modify
    sz:str=None     # Tailwind size suffix
):   
    "Round the corners for this element"
    return self.append_classes(f"rounded-{sz}" if sz else "rounded")


# %% ../nbs/00_core.ipynb 39
# Default rounded
p(Div("Default", cls="bg-blue-200 p-4").corner_radius())

# %% ../nbs/00_core.ipynb 40
# Specific sizes
p(Div("Small", cls="bg-green-200 p-4").corner_radius("sm"))

# %% ../nbs/00_core.ipynb 41
p(Div("Large", cls="bg-red-200 p-4").corner_radius("lg"))

# %% ../nbs/00_core.ipynb 42
p(Div("Full", cls="bg-yellow-200 p-4").corner_radius("full"))

# %% ../nbs/00_core.ipynb 43
p(Div("Chaining").padding().border().corner_radius("lg"))

# %% ../nbs/00_core.ipynb 45
@patch
def bg(
    self:FT,        # The FastTag element to modify
    color:str       # color of background
): 
    "Set background color"
    return self.append_classes(f"bg-{color}")

# %% ../nbs/00_core.ipynb 46
@patch
def fg(
    self:FT,        # The FastTag element to modify
    color:str       # color of foreground
): 
    "Set foreground color"
    return self.append_classes(f"text-{color}")

# %% ../nbs/00_core.ipynb 48
# Background color
p(Div("Blue background").padding().bg("blue-500"))

# %% ../nbs/00_core.ipynb 49
# Foreground/text color
p(Div("Red text").padding().fg("red-600"))

# %% ../nbs/00_core.ipynb 50
# Combined
p(Div("Yellow on purple", cls="p-4").bg("purple-700").fg("yellow-300"))

# %% ../nbs/00_core.ipynb 51
# With other modifiers
p(Div("Styled box", cls="p-4").bg("green-200").fg("green-900").corner_radius("lg").border(width=2, color="green-500"))

# %% ../nbs/00_core.ipynb 53
@patch
def shadow(self:FT,**kw):
    "Add shadow to element"
    # Parameters:
    # c: shadow color (default 'rgba(0,0,0,0.1)')
    # sz: preset size ('sm','md','lg', etc)
    # x,y,b,s: offset x, offset y, blur, spread
    if "c" not in kw: kw["c"] = "rgba(0,0,0,0.1)"
    
    if len(kw) == 0: return self.append_classes("shadow")
    if "sz" in kw: return self.append_classes(f"shadow-{kw['sz']}")
    
    def enc(c,x=0,y=1,b=3,s=0,**k2): return f"shadow-[{x}px_{y}px_{b}px_{s}px_{c}]"
    return self.append_classes(enc(**kw))

# %% ../nbs/00_core.ipynb 55
# Default shadow
p(Button("Default Shadow", cls="btn btn-primary").shadow())

# %% ../nbs/00_core.ipynb 56
# Custom color shadow
p(Button("Blue Shadow", cls="btn").shadow(c="rgba(0,0,255,0.5)", x=2, y=2, blur=8))

# %% ../nbs/00_core.ipynb 57
# Large offset shadow
p(Button("Offset Shadow", cls="btn btn-secondary").shadow(x=4, y=8, b=12))

# %% ../nbs/00_core.ipynb 58
# Red shadow
p(Button("Red Shadow", cls="btn btn-accent").shadow(color="red", blur=10))

# %% ../nbs/00_core.ipynb 60
@patch
def opacity(
    self:FT,        # The FastTag element to modify
    v:int=100       # Percent value of opacity as int
):
    "set opacity"
    return self.append_classes(f"opacity-{v}")

# %% ../nbs/00_core.ipynb 62
p(Div("Full opacity (default)", cls="bg-blue-500 p-4 text-white").opacity())

# %% ../nbs/00_core.ipynb 63
p(Div("75% opacity", cls="bg-red-500 p-4 text-white").opacity(75))

# %% ../nbs/00_core.ipynb 64
p(Div("50% opacity", cls="bg-green-500 p-4 text-white").opacity(50))

# %% ../nbs/00_core.ipynb 65
p(Div("25% opacity", cls="bg-purple-500 p-4 text-white").opacity(25))

# %% ../nbs/00_core.ipynb 66
p(Div(
    Div("100", cls="bg-blue-500 p-4 text-white").opacity(100),
    Div("75", cls="bg-blue-500 p-4 text-white").opacity(75),
    Div("50", cls="bg-blue-500 p-4 text-white").opacity(50),
    Div("25", cls="bg-blue-500 p-4 text-white").opacity(25)
))

# %% ../nbs/00_core.ipynb 68
@patch
def frame(
    self:FT,            # The FastTag element to modify 
    w=None,             # height of frame
    h=None,             # width of frame
    halign="center",    # horizontal alignment (default: center)
    valign="center"     # vertical alignment (default: center)
):
    "position this element in a frame"
    h_map = {"leading": "justify-start", "center": "justify-center", "trailing": "justify-end"}
    v_map = {"top": "items-start", "center": "items-center", "bottom": "items-end"}
    
    c = ["flex", h_map[halign], v_map[valign]]
    if w: c.append(f"w-{w}")
    if h: c.append(f"h-{h}")
    
    return Div(self).append_classes(*c)

# %% ../nbs/00_core.ipynb 70
# Basic frame with size
p(Div("Content", cls="bg-blue-200 p-2").frame(w=64, h=32))

# %% ../nbs/00_core.ipynb 71
# Different alignments
p(Div("Top Left", cls="bg-red-200 p-2").frame(w=96, h=48, valign="top",halign="leading"))

# %% ../nbs/00_core.ipynb 72
p(Div("Center", cls="bg-green-200 p-2").frame(w=96, h=48, halign="center"))

# %% ../nbs/00_core.ipynb 73
p(Div("Bottom Right", cls="bg-yellow-200 p-2").frame(w=96, h=48, valign="bottom",halign="trailing"))

# %% ../nbs/00_core.ipynb 74
# Just width or height
p(Div("Wide", cls="bg-purple-200 p-2").frame(w="full"))

# %% ../nbs/00_core.ipynb 75
p(Div("Tall", cls="bg-pink-200 p-2").frame(h=64))

# %% ../nbs/00_core.ipynb 77
@patch
def font(
    self:FT,        # The FastTag element to modify 
    sz=None,        # size
    wt=None         # weight
):
    "Set default font for this tag"
    c = []
    if sz: c.append(f"text-{sz}")
    if wt: c.append(f"font-{wt}")
    return self.append_classes(*c)

# %% ../nbs/00_core.ipynb 79
# Different font sizes
p(Div("Small text").font(sz="sm"))

# %% ../nbs/00_core.ipynb 80
p(Div("Base text").font(sz="base"))

# %% ../nbs/00_core.ipynb 81
p(Div("Large text").font(sz="lg"))

# %% ../nbs/00_core.ipynb 82
p(Div("Extra large text").font(sz="xl"))

# %% ../nbs/00_core.ipynb 83
p(Div("2XL text").font(sz="2xl"))

# %% ../nbs/00_core.ipynb 84
# Different font weights
p(Div("Light text").font(wt="light"))

# %% ../nbs/00_core.ipynb 85
p(Div("Normal text").font(wt="normal"))

# %% ../nbs/00_core.ipynb 86
p(Div("Bold text").font(wt="bold"))

# %% ../nbs/00_core.ipynb 87
# Combined size and weight
p(Div("Large and bold").font(sz="2xl",wt="bold"))

# %% ../nbs/00_core.ipynb 88
p(Div("Small and light").font(sz="sm",wt="light"))
